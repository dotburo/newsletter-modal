{"version":3,"file":"NewsletterModal.js","sources":["../src/js/defaults.js","../src/js/templates.js","../src/js/DomElement.js","../src/js/NewsletterModal.js","../src/js/NewsletterValidator.js","../src/js/NewsletterButton.js"],"sourcesContent":["export default {\n    url: null,\n    headers: {},\n    fields: {\n        firstname: false,\n        lastname: false,\n        email: true,\n        gdprCheckbox: false,\n        gdprNotice: false,\n    },\n    submitButtonText: 'Submit',\n    successMessage: 'Success!',\n};\n\nexport const INPUT_NAME_EMAIL = 'nws_email';\nexport const INPUT_NAME_CHECK = 'nws_gdpr';\nexport const INPUT_NAME_FIRST = 'nws_first';\nexport const INPUT_NAME_LAST = 'nws_last';\n","/**\n * Base newsletter subscription modal.\n * @param {object} options\n * @return string HTML\n */\nimport {INPUT_NAME_CHECK, INPUT_NAME_EMAIL, INPUT_NAME_FIRST, INPUT_NAME_LAST} from './defaults';\n\nexport const form = (options) => `\n<div class=\"modal-dialog modal-dialog-centered\">\n    <form class=\"modal-content\" action=\"/\" method=\"POST\">\n        <div class=\"modal-header\">\n            <h5 class=\"modal-title\">${options.title ? options.title : 'Subscribe to our newsletter'}</h5>\n            <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n              <span aria-hidden=\"true\" style=\"pointer-events: none\">&times;</span>\n            </button>\n        </div>\n        <div class=\"modal-body\">\n${\n    (options.fields.firstname ? firstName(options.fields.firstname) : '')\n    + (options.fields.lastname ? lastName(options.fields.lastname) : '')\n    + email(options.fields.email)\n    + (options.fields.gdprCheckbox ? gdprCheckbox(options.fields.gdprCheckbox) : '')\n}\n        </div>\n        <div class=\"modal-footer justify-content-between flex-wrap\">\n            ${options.fields.gdprNotice ? gdprNoticeLink(options.fields.gdprNotice) : '<span></span>'}\n            <button type=\"submit\" class=\"btn btn-primary nws-btn-submit\">${options.submitButtonText}</button>\n            ${options.fields.gdprNotice ? gdprNoticeText(options.fields.gdprNotice) : ''}\n        </div>\n    </form>\n</div>\n`;\n\n/**\n * Explicit agreement checkbox for GDPR.\n * @param {object} options\n * @return string HTML\n */\nconst gdprCheckbox = (options) => `\n<div>\n    <input type=\"checkbox\" id=\"nws-gdpr-check\" name=\"${INPUT_NAME_CHECK}\" required>\n    <label for=\"nws-gdpr-check\">${options.label}</label>\n    <span class=\"invalid-feedback\">${options.invalid || 'This is required.'}</span>\n</div>\n`;\n\n/**\n * A link to a privacy policy page or a button to toggle the GDPR disclaimer in the modal's footer.\n * @param {object} options\n * @return string HTML\n */\nconst gdprNoticeLink = (options) => {\n    if (options.url) {\n        return `<a href=\"${options.url}\" target=\"_blank\" rel=\"noreferrer\">${options.label}</a>`;\n    }\n\n    if (options.text) {\n        return `<a href=\"#\" class=\"nws-gdpr-btn\">${options.label} <span>ðŸ›ˆ</span></a>`;\n    }\n\n    return '';\n};\n\n/**\n * A collapsible GDPR disclaimer in the modal's footer.\n * @param {object} options\n * @return string HTML\n */\nconst gdprNoticeText = (options) => `\n<div class=\"nws-flex-break\"></div>\n<div class=\"nws-gdpr-txt\">\n    <div class=\"nws-gdpr-txt-inner\">${options.text}</div>\n</div>\n`;\n\n/**\n * Default required email field.\n * @param {object} options\n * @return string HTML\n */\nconst email = (options = {}) => `\n<label class=\"${!options.label ? 'sr-only' : ''}\">${options.label || 'Email'}</label>\n<div class=\"input-group\">\n    ${options.icon ? inputGroupIcon(options.icon) : ''}\n    <input type=\"email\" name=\"${INPUT_NAME_EMAIL}\" placeholder=\"Email\" required autocomplete=\"email\" class=\"form-control\" value=\"a@a.com\">\n    <div class=\"invalid-feedback\">${options.invalid || 'Please provide a valid email address.'}</div>\n</div>\n`;\n\n/**\n * First name field.\n * @param {object} options\n * @return string HTML\n */\nconst firstName = (options = {}) => `\n<label class=\"${!options.label ? 'sr-only' : ''}\">${options.label || 'First name'}</label>\n<div class=\"input-group\">\n    ${options.icon ? inputGroupIcon(options.icon) : ''}\n    <input type=\"text\" name=\"${INPUT_NAME_FIRST}\" placeholder=\"${options.placeholder || 'First name'}\" required class=\"form-control\">\n    <div class=\"invalid-feedback\">${options.invalid || 'Please provide a valid first name.'}</div>\n</div>\n`;\n\n/**\n * Last name field.\n * @param {object} options\n * @return string HTML\n */\nconst lastName = (options = {}) => `\n<label class=\"${!options.label ? 'sr-only' : ''}\">${options.label || 'Last name'}</label>\n<div class=\"input-group\">\n    ${options.icon ? inputGroupIcon(options.icon) : ''}\n    <input type=\"text\" name=\"${INPUT_NAME_LAST}\" placeholder=\"${options.placeholder || 'Last name'}\" required class=\"form-control\">\n    <div class=\"invalid-feedback\">${options.invalid || 'Please provide a valid last name.'}</div>\n</div>\n`;\n\n/**\n * The button to toggle the modal.\n * @param {string} label\n * @param {string} title\n * @return string HTML\n */\nexport const button = (label = 'Subscribe', title = '') => `\n<aside class=\"nws-cta\">\n    ${title ? `<h1>${title}</h1>`: ''}\n    <button type=\"button\" class=\"btn btn-primary\">${label}</button>\n</aside>\n`;\n\n/**\n * Show the user the request is being send.\n * @return string HTML\n */\nexport const spinner = () => 'sending...';\n\n/**\n * HTML for prepending an icon to an input field.\n * @param {string} icon\n * @return string HTML\n */\nconst inputGroupIcon = icon => {\n    return `\n<div class=\"input-group-prepend\">\n  <div class=\"input-group-text ${icon}\"></div>\n</div>\n`;\n};\n","const\n    d = document,\n    DEFAULTS = {\n        toggled: false,\n        classes: {\n            toggled: 'toggled'\n        }\n    };\n\nexport default class DomElement {\n    constructor(element, options = {}) {\n        this._options = options = Object.assign({}, DEFAULTS, options);\n\n        this._toggled = false;\n\n        this._events = [];\n\n        this._el = this._setElement(element);\n\n        if (options.toggled) {\n            this.toggle(true);\n        }\n    }\n\n    /**\n     * Display or hide element by adding or removing the classname.\n     * @param {Boolean|undefined} state\n     * @return DomElement\n     */\n    toggle(state = undefined) {\n        let classname = this.getOptions('classes').toggled;\n\n        this._toggled = state !== undefined ? state : !this._toggled;\n\n        this._el.classList[this._toggled ? 'add' : 'remove'](classname);\n\n        return this;\n    }\n\n    /**\n     * Bind a (delegated) event.\n     * @param {String} event\n     * @param {Function} fn\n     * @param {HTMLElement|Document} el\n     * @return DomElement\n     */\n    on(event, fn, el = null) {\n        (el || this._el).addEventListener(event, fn = fn.bind(this), true);\n\n        this._events.push({\n            name: event,\n            fn: fn,\n            el: el\n        });\n\n        return this;\n    }\n\n    /**\n     * Return the main wrapping element.\n     * @return {Element}\n     */\n    getElement(selector = '') {\n        return !selector ? this._el : this._el.querySelector(selector);\n    }\n\n    /**\n     * Check if the root element has child one.\n     * @return {Boolean}\n     */\n    hasElement(selector) {\n        return !!this._el.querySelector(selector);\n    }\n\n    /**\n     * Return the options.\n     * @param {string|null} key\n     * @return {object}\n     */\n    getOptions(key = null) {\n        return !key ? this._options : this._options[key];\n    }\n\n    /**\n     * Unbind all events and nullify references\n     * @return void\n     */\n    remove() {\n        this._events = this._events.filter(event => {\n            return (event.el || this._el).removeEventListener(event.name, event.fn, true);\n        });\n\n        this._el.parentNode.removeChild(this._el);\n\n        this._el = null;\n\n        this._options = DEFAULTS;\n    }\n\n    /**\n     * Query the element in the DOM if its a string\n     * @param {Element|String} el\n     * @return {Element|null}\n     * @protected\n     */\n    _setElement(el) {\n        if (!el || (!el.nodeType && typeof el !== 'string')) {\n            throw new Error('Wrong element type provided!');\n        }\n\n        if (el.nodeType) return el;\n\n        return (this._options.parent || d).querySelector(el);\n    }\n\n    /**\n     * Communicate changes\n     * @param {String} name\n     * @param {Object|null} detail\n     * @protected\n     */\n    _trigger(name, detail = null) {\n        let event;\n\n        if (typeof CustomEvent === 'function') {\n            event = new CustomEvent(name, {\n                detail: detail,\n                bubbles: true,\n                cancelable: true\n            });\n        } else {\n            event = d.createEvent('CustomEvent');\n            event.initCustomEvent(name, true, true, detail);\n        }\n\n        this._el.dispatchEvent(event);\n    }\n}\n","import {form, spinner} from './templates';\nimport DomElement from './DomElement';\n\nexport default class NewsletterModal extends DomElement {\n    constructor(element, options = {}, validator) {\n        super(element, options);\n\n        this.validator = validator;\n\n        this._render();\n    }\n\n    /**\n     * Instantiate the base element, which will hold the form.\n     * @return {HTMLDivElement}\n     */\n    static createElement() {\n        const el = document.createElement('div');\n\n        el.className = 'nws-modal modal';\n\n        return el;\n    }\n\n    /**\n     * Create the form and bind its events.\n     * @return void\n     * @private\n     */\n    _render() {\n        this.getElement().innerHTML = form(this.getOptions());\n\n        document.body.appendChild(this.getElement());\n\n        this.toggle(true);\n\n        this.on('submit', this._handleSubmit)\n            .on('click', this._handleClose)\n            .on('keyup', this._handleClose, document.body);\n\n        if (this.hasElement('.nws-gdpr-txt')) {\n            this.on('click', this._toggleGdpr, this.getElement('.nws-gdpr-btn'));\n        }\n    }\n\n    /**\n     * Close the form modal.\n     * @param {MouseEvent} e\n     * @private\n     */\n    _handleClose(e) {\n        const toggledClass = this.getOptions('classes').toggled,\n            clickedWrapper = e.target.classList.contains(toggledClass),\n            clickedButton = e.target.classList.contains('close'),\n            pressedEscape = e.key === 'Escape';\n\n        if (clickedWrapper || pressedEscape || clickedButton) {\n            e.preventDefault();\n            this.toggle(false);\n        }\n    }\n\n    /**\n     * Validate the data and display messages accordingly.\n     * @param {MouseEvent} e\n     * @private\n     */\n    _handleSubmit(e) {\n        e.preventDefault();\n\n        this._setLoading(true);\n\n        const form = this.getElement('form');\n\n        if (!this.validator.validate(form)) {\n            this._setLoading(false);\n            return;\n        }\n\n        this._submit(this.validator.getData())\n            .then(response => {\n                if (response.ok) {\n                    return this._message(this.getOptions('successMessage'));\n                }\n\n                throw new Error(response.statusText);\n            })\n            .catch(error => {\n                this._message(error.message)\n                    ._setLoading(false);\n            });\n    }\n\n    /**\n     * Send the data to the server.\n     * @param {object} data\n     * @return {Promise<Response>}\n     * @private\n     */\n    _submit(data) {\n        return window.fetch(this.getOptions('url'), {\n            method: 'POST',\n            headers: Object.assign(this.getOptions('headers'), {\n                'Content-Type': 'application/json',\n            }),\n            body: JSON.stringify(data)\n        });\n    }\n\n    /**\n     * Show the user the request is being made.\n     * @param {boolean} state\n     * @return {NewsletterModal}\n     * @private\n     */\n    _setLoading(state) {\n        const btn = this.getElement('.nws-btn-submit');\n\n        if (state) {\n            btn.innerHTML = spinner();\n        } else {\n            btn.innerHTML = this.getOptions('submitButtonText');\n        }\n\n        return this;\n    }\n\n    /**\n     * Show an error or success message in the form.\n     * @param {string} msg\n     * @return {NewsletterModal}\n     * @private\n     */\n    _message(msg) {\n        this.getElement('.nws-msg').textContent = msg;\n\n        return this;\n    }\n\n    /**\n     * Hide or show the GDPR disclaimer.\n     * @return void\n     * @private\n     */\n    _toggleGdpr() {\n        const notice = this.getElement('.nws-gdpr-txt');\n\n        if (notice.classList.toggle('toggled')) {\n            notice.style.height = notice.firstElementChild.clientHeight + 'px';\n        } else {\n            notice.style.height = '0';\n        }\n    }\n}\n","import {INPUT_NAME_CHECK, INPUT_NAME_EMAIL, INPUT_NAME_FIRST, INPUT_NAME_LAST} from './defaults';\n\nexport default class {\n    constructor() {\n        this.validationMap = {\n            [INPUT_NAME_EMAIL]: this._validateEmail.bind(this),\n            [INPUT_NAME_CHECK]: this._validateGdprCheck.bind(this),\n            [INPUT_NAME_FIRST]: this._validateName.bind(this),\n            [INPUT_NAME_LAST]: this._validateName.bind(this),\n        };\n\n        this._data = {};\n    }\n\n    /**\n     * Validate all element of the given form.\n     * @param {HTMLFormElement} form\n     * @return {boolean}\n     */\n    validate(form) {\n        const elements = form.elements;\n\n        let valid = true;\n\n        for(let i = 0, l = elements.length, element; i < l; i++) {\n            element = elements.item(i);\n            if (element.name) {\n                valid = this.validationMap[element.name](element);\n            }\n        }\n\n        return valid;\n    }\n\n    /**\n     * Validate the email.\n     * @param {HTMLInputElement} element\n     * @return {boolean}\n     * @private\n     */\n    _validateEmail(element) {\n        const valid = /^.*@.*..*/.test(element.value);\n\n        if (valid) {\n            this._setData(element.name, element.value);\n        }\n\n        this._setElement(element, valid);\n\n        return valid;\n    }\n\n    /**\n     * Validate the first or last name.\n     * @param {HTMLInputElement} element\n     * @return {boolean}\n     * @private\n     */\n    _validateName(element) {\n        const valid = !element.value.match(/\\d/g);\n\n        if (valid) {\n            this._setData(element.name, element.value);\n        }\n\n        this._setElement(element, valid);\n\n        return valid;\n    }\n\n    /**\n     * Make sure the GDPR checkbox is checked.\n     * @param {HTMLInputElement} element\n     * @return {boolean}\n     * @private\n     */\n    _validateGdprCheck(element) {\n        const valid = element.checked;\n\n        if (valid) {\n            this._setData(element.name, true);\n        }\n\n        this._setElement(element, valid);\n\n        return valid;\n    }\n\n    _setElement(element, state) {\n        element.classList[state ? 'remove' : 'add']('is-invalid');\n    }\n\n    /**\n     * Store the valid data.\n     * @param {string} key\n     * @param {*} value\n     * @private\n     */\n    _setData(key, value) {\n        this._data[key] = value;\n    }\n\n    /**\n     * Return the valid data.\n     * @return {{}}\n     */\n    getData() {\n        return this._data;\n    }\n}\n","import {button} from './templates';\nimport DomElement from './DomElement';\nimport defaults from './defaults';\nimport NewsletterModal from './NewsletterModal';\nimport NewsletterValidator from './NewsletterValidator';\n\nimport '../css/bootstrapped.scss';\n\nconst CLASSNAME_TOGGLED = 'nws-toggled';\n\nlet modalInstance = null;\n\nexport default class extends DomElement {\n    constructor(element, options = {}) {\n        options = Object.assign({}, defaults, options);\n\n        options.fields = options.fields || {};\n        options.classes = options.classes || {};\n        options.classes.toggled = CLASSNAME_TOGGLED;\n\n        super(element, options);\n\n        this._render();\n    }\n\n    /**\n     * Render the button to open the modal.\n     * @protected\n     */\n    _render() {\n        this.getElement().innerHTML = button();\n\n        this.on('click', this._handleSubscribeButton);\n    }\n\n    /**\n     * Instantiate and/or toggle the modal.\n     * @return void\n     * @protected\n     */\n    _handleSubscribeButton() {\n        if (modalInstance) {\n            modalInstance.toggle(true);\n            return;\n        }\n\n        modalInstance = new NewsletterModal(\n            NewsletterModal.createElement(),\n            this.getOptions(),\n            new NewsletterValidator()\n        );\n    }\n}\n"],"names":[],"mappings":"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"}